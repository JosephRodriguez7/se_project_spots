!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_active"},t=(e,t,o)=>{const n=e.querySelector(`#${t.id}-error`);t.classList.remove(o.inputErrorClass),n.classList.remove(o.errorClass)},o=(e,t,o)=>{(e=>e.some(e=>!e.validity.valid))(e)?(t.disabled=!0,t.classList.add(o.inactiveButtonClass)):(t.disabled=!1,t.classList.remove(o.inactiveButtonClass))},n=e=>{const n=document.querySelectorAll(e.formSelector);n.forEach(n=>{((e,n)=>{const r=Array.from(e.querySelectorAll(n.inputSelector)),c=e.querySelector(n.submitButtonSelector);console.log(r),console.log(c),o(r,c,n),r.forEach(s=>{s.addEventListener("input",function(){((e,o,n)=>{console.log(o.validationMessage),o.validity.valid?t(e,o,n):((e,t,o,n)=>{const r=t.id+"-error",c=e.querySelector(`#${t.id}-error`);c.textContent=o,console.log(r),c.classList.add(n.errorClass),t.classList.add(n.inputErrorClass)})(e,o,o.validationMessage,n)})(e,s,n),o(r,c,n)})})})(n,e)}),console.log(n)},r=(e,n)=>{const r=Array.from(e.querySelectorAll(n.inputSelector)),c=e.querySelector(n.submitButtonSelector);r.forEach(o=>{t(e,o,n)}),o(r,c,n)};n(e);const c=document.querySelector("#card-modal"),s=c.querySelector(".modal__close-button_alt"),l=c.querySelector(".modal__card-image"),a=c.querySelector(".modal__card-caption"),i=document.querySelector(".cards__list"),u=document.querySelector("#card-template"),d=document.querySelector(".profile__title"),m=document.querySelector(".profile__description"),p=document.querySelector("#name-input"),f=document.querySelector("#description-input"),y=(document.querySelector(".modal__submit-button"),document.querySelector("#caption-input")),_=document.querySelector("#image-link-input"),S=(document.querySelector(".modal__submit-button"),document.querySelector("#editProfileBtn")),v=document.querySelector("#newPostBtn"),g=document.querySelector("#edit-profile-modal"),q=document.querySelector("#new-post-modal"),w=g.querySelector(".modal__close-button"),b=q.querySelector(".modal__close-button");function h(e){e.classList.add("modal_is-opened"),document.addEventListener("keydown",E)}function k(e){e.classList.remove("modal_is-opened"),document.removeEventListener("keydown",E)}function L(e){const t=u.content.querySelector(".card").cloneNode(!0),o=t.querySelector(".card__caption"),n=t.querySelector(".card__image"),r=t.querySelector(".card__like-button");return r.addEventListener("click",function(){r.classList.toggle("card__like-button_active")}),t.querySelector(".card__delete-button").addEventListener("click",function(){t.classList.add("card_deleted"),setTimeout(()=>t.remove(),500)}),n.addEventListener("click",function(){l.src=e.link,l.alt=e.name,a.textContent=e.name,h(c)}),n.src=e.link,n.alt=e.name,o.textContent=e.name,t}S.addEventListener("click",function(){h(g);const t=g.querySelector(e.formSelector);r(t,e),p.value=d.textContent,f.value=m.textContent}),w.addEventListener("click",function(){k(g),console.log("modalProfileCloseBtn was clicked")}),s.addEventListener("click",function(){k(c),console.log("previewCardCloseBtn was clicked")}),g.addEventListener("submit",function(e){e.preventDefault(),d.textContent=p.value,m.textContent=f.value,k(g)}),q.addEventListener("submit",function(t){t.preventDefault(),k(q),console.log(y.value),console.log(_.value);const n=L({name:y.value,link:_.value});i.prepend(n);const c=t.target,s=c.querySelector(e.submitButtonSelector),l=Array.from(c.querySelectorAll(e.inputSelector));c.reset(),o(l,s,e),r(c,e)}),v.addEventListener("click",function(){h(q);const t=q.querySelector(e.formSelector);r(t,e)}),b.addEventListener("click",function(){k(q),console.log("modalPostCloseBtn was clicked")}),[{name:"Golden Gate Bridge",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/7-photo-by-griffin-wooldridge-from-pexels.jpg"},{name:"Val Thorens",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/1-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Restaurant terrace",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/2-photo-by-ceiline-from-pexels.jpg"},{name:"An outdoor cafe",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/3-photo-by-tubanur-dogan-from-pexels.jpg"},{name:"A very long bridge, over the forest and through the trees",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/4-photo-by-maurice-laschet-from-pexels.jpg"},{name:"Tunnel with morning light",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/5-photo-by-van-anh-nguyen-from-pexels.jpg"},{name:"Mountain house",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/6-photo-by-moritz-feldmann-from-pexels.jpg"}].forEach(function(e){const t=L(e);i.append(t)});const E=e=>{if("Escape"===e.key){const e=document.querySelector(".modal_is-opened");e&&k(e)}},C=e=>{e.target.classList.contains("modal_is-opened")&&k(e.target)};document.querySelectorAll(".modal").forEach(e=>{e.addEventListener("mousedown",C)}),n(e)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBa0IxQixpQkFBaUIsUUFBUyxXQUMxQzhCLEVBQVdOLEdBQ1gxQixRQUFRQyxJQUFJLGdDQUNkLEdBak1xQixDQUNuQixDQUNFOEMsS0FBTSxxQkFDTkYsS0FBTSw4SEFHUixDQUNFRSxLQUFNLGNBQ05GLEtBQU0sMkhBR1IsQ0FDRUUsS0FBTSxxQkFDTkYsS0FBTSxtSEFHUixDQUNFRSxLQUFNLGtCQUNORixLQUFNLHlIQUdSLENBQ0VFLEtBQU0sNERBQ05GLEtBQU0sMkhBR1IsQ0FDRUUsS0FBTSw0QkFDTkYsS0FBTSwwSEFHUixDQUNFRSxLQUFNLGlCQUNORixLQUFNLDRIQW1LR2pELFFBQVEsU0FBVTRELEdBQzdCLE1BQU1wQixFQUFjRixFQUFlc0IsR0FDbkN6QyxFQUFlMEMsT0FBT3JCLEVBQ3hCLEdBR0EsTUFBTUwsRUFBaUJtQixJQUNyQixHQUFnQixXQUFaQSxFQUFJUSxJQUFrQixDQUN4QixNQUFNQyxFQUFjakUsU0FBU2YsY0FBYyxvQkFDdkNnRixHQUNGM0IsRUFBVzJCLEVBRWYsR0FJSUMsRUFBMEJWLElBQzFCQSxFQUFJRyxPQUFPeEUsVUFBVWdGLFNBQVMsb0JBQ2hDN0IsRUFBV2tCLEVBQUlHLFNBS0QzRCxTQUFTQyxpQkFBaUIsVUFDbENDLFFBQVNrQyxJQUNqQkEsRUFBTTVCLGlCQUFpQixZQUFhMEQsS0FHdENwRSxFQUFpQnhCLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvbW9kdWxlcy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9pbmFjdGl2ZVwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfYWN0aXZlXCIsXG59O1xuXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIHNldHRpbmdzKSA9PiB7XG4gIGNvbnN0IGVycm9yTWVzc2FnZUlEID0gaW5wdXRFbGVtZW50LmlkICsgXCItZXJyb3JcIjtcbiAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICk7XG4gIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gIGNvbnNvbGUubG9nKGVycm9yTWVzc2FnZUlEKTtcbiAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKHNldHRpbmdzLmVycm9yQ2xhc3MpO1xuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xufTtcblxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgc2V0dGluZ3MpID0+IHtcbiAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICk7XG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XG4gIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShzZXR0aW5ncy5lcnJvckNsYXNzKTtcbn07XG5cbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBzZXR0aW5ncykgPT4ge1xuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH0gZWxzZSB7XG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgfVxufTtcblxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHNldHRpbmdzKSA9PiB7XG4gIGNvbnNvbGUubG9nKGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoXG4gICAgICBmb3JtRWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcbiAgICAgIHNldHRpbmdzXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBzZXR0aW5ncyk7XG4gIH1cbn07XG5cbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbGVtZW50LCBzZXR0aW5ncykgPT4ge1xuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuaW5wdXRTZWxlY3RvcilcbiAgKTtcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgKTtcblxuICBjb25zb2xlLmxvZyhpbnB1dExpc3QpO1xuICBjb25zb2xlLmxvZyhidXR0b25FbGVtZW50KTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIHNldHRpbmdzKTtcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgc2V0dGluZ3MpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBzZXR0aW5ncyk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoc2V0dGluZ3MpID0+IHtcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNldHRpbmdzLmZvcm1TZWxlY3Rvcik7XG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQsIHNldHRpbmdzKTtcbiAgfSk7XG4gIGNvbnNvbGUubG9nKGZvcm1MaXN0KTtcbn07XG5cbmV4cG9ydCBjb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsZW1lbnQsIHNldHRpbmdzKSA9PiB7XG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxuICApO1xuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxuICApO1xuXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dCwgc2V0dGluZ3MpO1xuICB9KTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIHNldHRpbmdzKTtcbn07XG5cbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCB7XG4gIGVuYWJsZVZhbGlkYXRpb24sXG4gIHJlc2V0VmFsaWRhdGlvbixcbiAgdG9nZ2xlQnV0dG9uU3RhdGUsXG4gIHNldHRpbmdzLFxufSBmcm9tIFwiLi4vc2NyaXB0cy9tb2R1bGVzL3ZhbGlkYXRpb24uanNcIjtcblxuLy9jYXJkcyBhcnJheVxuY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJHb2xkZW4gR2F0ZSBCcmlkZ2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNy1waG90by1ieS1ncmlmZmluLXdvb2xkcmlkZ2UtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG5cbiAge1xuICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG5cbiAge1xuICAgIG5hbWU6IFwiUmVzdGF1cmFudCB0ZXJyYWNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzItcGhvdG8tYnktY2VpbGluZS1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcblxuICB7XG4gICAgbmFtZTogXCJBbiBvdXRkb29yIGNhZmVcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMy1waG90by1ieS10dWJhbnVyLWRvZ2FuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuXG4gIHtcbiAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy80LXBob3RvLWJ5LW1hdXJpY2UtbGFzY2hldC1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcblxuICB7XG4gICAgbmFtZTogXCJUdW5uZWwgd2l0aCBtb3JuaW5nIGxpZ2h0XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzUtcGhvdG8tYnktdmFuLWFuaC1uZ3V5ZW4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG5cbiAge1xuICAgIG5hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNi1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG5dO1xuXG4vL21vZGFsIGNhcmQgc2VsZWN0b3JzXG5jb25zdCBwcmV2aWV3Q2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLW1vZGFsXCIpO1xuY29uc3QgcHJldmlld0NhcmRDbG9zZUJ0biA9IHByZXZpZXdDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvbl9hbHRcIlxuKTtcbmNvbnN0IHByZXZpZXdDYXJkSW1hZ2VFbCA9IHByZXZpZXdDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FyZC1pbWFnZVwiKTtcbmNvbnN0IHByZXZpZXdDYXJkQ2FwdGlvbkVsID0gcHJldmlld0NhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9fY2FyZC1jYXB0aW9uXCJcbik7XG5cbi8vY2FyZCBzZWxlY3RvcnNcbmNvbnN0IGNhcmRzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcblxuLy9lZGl0IHByb2ZpbGUgbW9kYWxcbmNvbnN0IHByb2ZpbGVOYW1lRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuY29uc3QgcHJvZmlsZU5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmFtZS1pbnB1dFwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZXNjcmlwdGlvbi1pbnB1dFwiKTtcbmNvbnN0IHByb2ZpbGVTYXZlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcblxuLy9uZXcgcG9zdCBtb2RhbFxuY29uc3QgcG9zdENhcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FwdGlvbi1pbnB1dFwiKTtcbmNvbnN0IHBvc3RMaW5rSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ltYWdlLWxpbmstaW5wdXRcIik7XG5jb25zdCBwb3N0U2F2ZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIik7XG5cbi8vb3BlbiBidXR0b24gc2VsZWN0b3JzXG5jb25zdCBlZGl0UHJvZmlsZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdFByb2ZpbGVCdG5cIik7XG5jb25zdCBuZXdQb3N0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXdQb3N0QnRuXCIpO1xuXG4vL21vZGFsIHNlbGVjdG9yc1xuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIpO1xuY29uc3QgbmV3UG9zdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXctcG9zdC1tb2RhbFwiKTtcblxuLy9jbG9zZSBidXR0b25zXG5jb25zdCBtb2RhbFByb2ZpbGVDbG9zZUJ0biA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiXG4pO1xuY29uc3QgbW9kYWxQb3N0Q2xvc2VCdG4gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xuXG4vL2VkaXQgcHJvZmlsZSBldmVudHNcbmVkaXRQcm9maWxlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIG9wZW5Nb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcblxuICBjb25zdCBmb3JtID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKHNldHRpbmdzLmZvcm1TZWxlY3Rvcik7XG4gIHJlc2V0VmFsaWRhdGlvbihmb3JtLCBzZXR0aW5ncyk7XG4gIHByb2ZpbGVOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZUVsLnRleHRDb250ZW50O1xuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbkVsLnRleHRDb250ZW50O1xufSk7XG5cbm1vZGFsUHJvZmlsZUNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XG4gIGNvbnNvbGUubG9nKFwibW9kYWxQcm9maWxlQ2xvc2VCdG4gd2FzIGNsaWNrZWRcIik7XG59KTtcblxucHJldmlld0NhcmRDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBjbG9zZU1vZGFsKHByZXZpZXdDYXJkTW9kYWwpO1xuICBjb25zb2xlLmxvZyhcInByZXZpZXdDYXJkQ2xvc2VCdG4gd2FzIGNsaWNrZWRcIik7XG59KTtcblxuLy9vcGVuICYgY2xvc2UgbW9kYWwgZnVuY3Rpb25zOiBTVEFSVFxuLy9vcGVuIG1vZGFsIGZ1bmN0aW9uXG5cbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfaXMtb3BlbmVkXCIpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBjbG9zZU1vZGFsRXNjKTtcbn1cblxuLy8gY2xvc2UgbW9kYWwgZnVuY3Rpb25cblxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfaXMtb3BlbmVkXCIpO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBjbG9zZU1vZGFsRXNjKTtcbn1cbi8vb3BlbiAmIGNsb3NlIG1vZGFsIGZ1bmN0aW9uczogRU5EXG5cbi8vZWRpdCBwcm9maWxlIHN1Ym1pc3Npb24gZnVuY3Rpb25zXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIHByb2ZpbGVOYW1lRWwudGV4dENvbnRlbnQgPSBwcm9maWxlTmFtZUlucHV0LnZhbHVlO1xuICBwcm9maWxlRGVzY3JpcHRpb25FbC50ZXh0Q29udGVudCA9IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlO1xuICBjbG9zZU1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xufVxuZWRpdFByb2ZpbGVNb2RhbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KTtcbi8vIGVuZCBvZiBmdW5jdGlvbi8vXG5cbi8vbmV3IHBvc3Qgc3VibWlzc2lvbiBmdW5jdGlvbnNcbmZ1bmN0aW9uIGhhbmRsZVBvc3RGb3JtU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY2xvc2VNb2RhbChuZXdQb3N0TW9kYWwpO1xuICBjb25zb2xlLmxvZyhwb3N0Q2FwdGlvbklucHV0LnZhbHVlKTtcbiAgY29uc29sZS5sb2cocG9zdExpbmtJbnB1dC52YWx1ZSk7XG5cbiAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7XG4gICAgbmFtZTogcG9zdENhcHRpb25JbnB1dC52YWx1ZSxcbiAgICBsaW5rOiBwb3N0TGlua0lucHV0LnZhbHVlLFxuICB9O1xuXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoaW5wdXRWYWx1ZXMpO1xuICBjYXJkc0NvbnRhaW5lci5wcmVwZW5kKGNhcmRFbGVtZW50KTtcblxuICBjb25zdCBmb3JtID0gZXZ0LnRhcmdldDtcbiAgY29uc3Qgc3VibWl0QnRuID0gZm9ybS5xdWVyeVNlbGVjdG9yKHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuaW5wdXRTZWxlY3RvcikpO1xuICBmb3JtLnJlc2V0KCk7XG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgc3VibWl0QnRuLCBzZXR0aW5ncyk7XG4gIHJlc2V0VmFsaWRhdGlvbihmb3JtLCBzZXR0aW5ncyk7XG59XG5uZXdQb3N0TW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVQb3N0Rm9ybVN1Ym1pdCk7XG4vLyBlbmQgb2YgZnVuY3Rpb24vL1xuXG4vL2NhcmQgZWxlbWVudCBmdW5jdGlvbi1TVEFSVDpcblxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XG4gICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgY29uc3QgY2FyZENhcHRpb25FbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19jYXB0aW9uXCIpO1xuICBjb25zdCBjYXJkSW1hZ2VFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgY29uc3QgY2FyZExpa2VCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICBjYXJkTGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICAgIGNhcmRMaWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gIH0pO1xuXG4gIGNvbnN0IGNhcmREZWxCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XG4gIGNhcmREZWxCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICBjYXJkRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiY2FyZF9kZWxldGVkXCIpO1xuICAgIHNldFRpbWVvdXQoKCkgPT4gY2FyZEVsZW1lbnQucmVtb3ZlKCksIDUwMCk7XG4gIH0pO1xuXG4gIGNhcmRJbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICBwcmV2aWV3Q2FyZEltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xuICAgIHByZXZpZXdDYXJkSW1hZ2VFbC5hbHQgPSBkYXRhLm5hbWU7XG4gICAgcHJldmlld0NhcmRDYXB0aW9uRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgb3Blbk1vZGFsKHByZXZpZXdDYXJkTW9kYWwpO1xuICB9KTtcblxuICBjYXJkSW1hZ2VFbGVtZW50LnNyYyA9IGRhdGEubGluaztcbiAgY2FyZEltYWdlRWxlbWVudC5hbHQgPSBkYXRhLm5hbWU7XG4gIGNhcmRDYXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcblxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbi8vbmV3IHBvc3QgZXZlbnRzXG5uZXdQb3N0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIG9wZW5Nb2RhbChuZXdQb3N0TW9kYWwpO1xuXG4gIGNvbnN0IGZvcm0gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihzZXR0aW5ncy5mb3JtU2VsZWN0b3IpO1xuICByZXNldFZhbGlkYXRpb24oZm9ybSwgc2V0dGluZ3MpO1xufSk7XG5cbm1vZGFsUG9zdENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcbiAgY29uc29sZS5sb2coXCJtb2RhbFBvc3RDbG9zZUJ0biB3YXMgY2xpY2tlZFwiKTtcbn0pO1xuXG4vLyBmb3IgbG9vcCBjYXJkc1xuaW5pdGlhbENhcmRzLmZvckVhY2goZnVuY3Rpb24gKGNhcmQpIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChjYXJkKTtcbiAgY2FyZHNDb250YWluZXIuYXBwZW5kKGNhcmRFbGVtZW50KTtcbn0pO1xuXG4vLyBjbG9zaW5nIG1vZGFscyB3LyBlc2Mga2V5XG5jb25zdCBjbG9zZU1vZGFsRXNjID0gKGV2dCkgPT4ge1xuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgIGNvbnN0IG9wZW5lZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9pcy1vcGVuZWRcIik7XG4gICAgaWYgKG9wZW5lZE1vZGFsKSB7XG4gICAgICBjbG9zZU1vZGFsKG9wZW5lZE1vZGFsKTtcbiAgICB9XG4gIH1cbn07XG5cbi8vIGNsb3NpbmcgbW9kYWxzIGJ5IGNsaWNraW5nIG92ZXJsYXlcbmNvbnN0IGNsb3NlTW9kYWxPdmVybGF5Q2xpY2sgPSAoZXZ0KSA9PiB7XG4gIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX2lzLW9wZW5lZFwiKSkge1xuICAgIGNsb3NlTW9kYWwoZXZ0LnRhcmdldCk7XG4gIH1cbn07XG5cbi8vIGFsbE1vZGFscyBzZWxlY3RvclxuY29uc3QgYWxsTW9kYWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKTtcbmFsbE1vZGFscy5mb3JFYWNoKChtb2RhbCkgPT4ge1xuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGNsb3NlTW9kYWxPdmVybGF5Q2xpY2spO1xufSk7XG5cbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuIl0sIm5hbWVzIjpbInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiYnV0dG9uRWxlbWVudCIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZWQiLCJhZGQiLCJlbmFibGVWYWxpZGF0aW9uIiwiZm9ybUxpc3QiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJBcnJheSIsImZyb20iLCJjb25zb2xlIiwibG9nIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkYXRpb25NZXNzYWdlIiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1lc3NhZ2UiLCJlcnJvck1lc3NhZ2VJRCIsInRleHRDb250ZW50IiwicmVzZXRWYWxpZGF0aW9uIiwiaW5wdXQiLCJwcmV2aWV3Q2FyZE1vZGFsIiwicHJldmlld0NhcmRDbG9zZUJ0biIsInByZXZpZXdDYXJkSW1hZ2VFbCIsInByZXZpZXdDYXJkQ2FwdGlvbkVsIiwiY2FyZHNDb250YWluZXIiLCJjYXJkVGVtcGxhdGUiLCJwcm9maWxlTmFtZUVsIiwicHJvZmlsZURlc2NyaXB0aW9uRWwiLCJwcm9maWxlTmFtZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJwb3N0Q2FwdGlvbklucHV0IiwicG9zdExpbmtJbnB1dCIsImVkaXRQcm9maWxlQnRuIiwibmV3UG9zdEJ0biIsImVkaXRQcm9maWxlTW9kYWwiLCJuZXdQb3N0TW9kYWwiLCJtb2RhbFByb2ZpbGVDbG9zZUJ0biIsIm1vZGFsUG9zdENsb3NlQnRuIiwib3Blbk1vZGFsIiwibW9kYWwiLCJjbG9zZU1vZGFsRXNjIiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJnZXRDYXJkRWxlbWVudCIsImRhdGEiLCJjYXJkRWxlbWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkQ2FwdGlvbkVsZW1lbnQiLCJjYXJkSW1hZ2VFbGVtZW50IiwiY2FyZExpa2VCdG4iLCJ0b2dnbGUiLCJzZXRUaW1lb3V0Iiwic3JjIiwibGluayIsImFsdCIsIm5hbWUiLCJmb3JtIiwidmFsdWUiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInByZXBlbmQiLCJ0YXJnZXQiLCJzdWJtaXRCdG4iLCJyZXNldCIsImNhcmQiLCJhcHBlbmQiLCJrZXkiLCJvcGVuZWRNb2RhbCIsImNsb3NlTW9kYWxPdmVybGF5Q2xpY2siLCJjb250YWlucyJdLCJzb3VyY2VSb290IjoiIn0=